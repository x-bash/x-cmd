#! /bin/sh
# shellcheck disable=SC2006,SC1091,SC3043

___x_cmd_xbin_findsrc(){
    [ -n "$___X_CMD_ROOT_MOD" ] && return
    local IFS="
"

    local folder
    while read -r folder; do
        if [ -f "$folder/xrc/latest" ]; then
            . "$folder/xrc/latest"
            return
        fi
    done <<A
$(pwd)/.x-cmd
$HOME/.x-cmd
/var/.x-cmd
/usr/bin/.x-cmd
A

    cat >&2 <<A
No x-cmd found in this computer.
Type following cmd to setup:        eval `x init`
If you need help, type:             eval `x help`
A
    return 1
}

___x_cmd_xbin_findsrc || exit 1

# ___x_cmd_xbin_init(){
#     if [ ! -t 1 ]; then
#         cat >&2 <<A
# This should be executed by:   eval `x init`
# If you need help, type:       eval `x help`
# A
#         return 1
#     fi
#     if [ -n "$___X_CMD_ROOT_MOD" ]; then
#         cat <<A
# # This should be executed by:       eval `x init`
# # If you need help, type:           eval `x help`

# . "${___X_CMD_ROOT_MOD}/xrc/latest";
# x boot setup;
# A

#     else
#         printf "%s" "curl https://get.x-cmd.com"
#     fi
# }

# x(){
#     if [ "$1" = init ]; then
#         ___x_cmd_xbin_init
#         return
#     fi

#     . "$___X_CMD_ROOT_MOD/xrc/latest" && x "$@"
# }

___x_cmd_main "$@"

