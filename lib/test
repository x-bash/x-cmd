x log init test

___x_cmd_test(){
   ___x_cmd_test_main "$@"
}

___x_cmd_test_main(){
    local target="${1}"
    if [ -z "$target" ]; then
        target="$(x wsroot)/.x-cmd/testcase"
    fi
    if [ ! -d "$target" ]; then
        test:warn "Expecting to be folder: $target"
        return 1
    fi
    cd "$target" && ___x_cmd_test_folder "$(pwd)"
}

___x_cmd_test_folder(){
    test:info "Test: $(basename "$target")"
    for i in *; do
        case "$i" in
            setup)      continue ;;
            teardown)   continue ;;
        esac
        if [ -f "$i" ]; then
            (
                . ./setup
                . "$i";
                . ./teardown
            )
        elif [ -d "$i" ]; then
            ( cd "$i" && ___x_cmd_test_folder "$(pwd)"; )
        else
            :
        fi
    done
}
